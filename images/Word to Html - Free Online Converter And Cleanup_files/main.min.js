function cleanup(){var e=htmlCodeMirror.getValue();if($("#removeFormatting").is(":checked")&&(e=e.replace(/(<[^<>]+) style=['"][^'"<>]*['"]/gi,"$1"),e=e.replace(/(<[^<>]+) style=[^'"<> ]+/gi,"$1"),e=e.replace(/(<[^<>]+) class=['"][^'"<>]*['"]/gi,"$1"),e=e.replace(/(<[^<>]+) class=[^'"<> ]+/gi,"$1"),e=e.replace(/<style[\s\S]*?<\/style>\s*/gim,"")),$("#removeSpanTags").is(":checked")&&(e=e.replace(/<span[^<>]*>([\s\S]*?)<\/span>/gim,"$1")),$("#removeIds").is(":checked")&&(e=e.replace(/(<[^<>]+) id=['"][^'"<>]*['"]/gi,"$1")),$("#removeScripts").is(":checked")&&(e=e.replace(/<script[\s\S]*?<\/script>\s*/gim,"")),$("#removeImages").is(":checked")&&(e=e.replace(/<img[^<>]*>\s*/gim,"")),$("#removeLinks").is(":checked")&&(e=e.replace(/<a [\s\S]*?<\/a>\s*/gim,"")),$("#removeTables").is(":checked")&&(e=e.replace(/<table[\s\S]*?<\/table>\s*/gim,"")),$("#removeForms").is(":checked")&&(e=e.replace(/<form[\s\S]*?<\/form>\s*/gim,"")),$("#removeAnyEmptyTag").is(":checked")&&(e=e.replace(/<([a-z0-9]+)[^<>]*><\/\1>\s*/gim,"")),$("#removeTagsWithWhitespace").is(":checked")&&(e=e.replace(/<([a-z0-9]+)[^<>]*>(\s|&nbsp;)*<\/\1>\s*/gim,"")),$("#removeAllTagAttributes").is(":checked")&&(e=e.replace(/<([a-z0-9]+) [^<>]+>/gim,"<$1>")),$("#removeComments").is(":checked")&&(e=e.replace(/<!--[\s\S]*?-->\s*/gim,"")),$("#find").length>0)if($("#useRegex").is(":checked")){var t=new RegExp($("#find").val(),"gim");e=e.replace(t,$("#replace").val())}else e=e.replace($("#find").val(),$("#replace").val());htmlCodeMirror.setValue(e),tinymce.activeEditor.setContent(e)}var htmlCodeMirror,updateTiny=!1;$("document").ready(function(){htmlCodeMirror=CodeMirror.fromTextArea(htmlOutput,{mode:"text/html",lineNumbers:!0,lineWrapping:!0,extraKeys:{F11:function(e){e.setOption("fullScreen",!e.getOption("fullScreen"))},Esc:function(e){e.getOption("fullScreen")&&e.setOption("fullScreen",!1)}}}),htmlCodeMirror.on("change",function(e){updateTiny&&tinymce.activeEditor.setContent(e.getValue())}),htmlCodeMirror.on("focus",function(){updateTiny=!0}),htmlCodeMirror.on("blur",function(){updateTiny=!1}),tinymce.init({selector:"textarea.pastedContent",plugins:["advlist autolink lists link image charmap preview anchor","searchreplace visualblocks code","insertdatetime media table contextmenu paste"],toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image",setup:function(e){e.on("change",function(){htmlCodeMirror.setValue(tinymce.activeEditor.getContent())}),e.on("init",function(){htmlCodeMirror.setValue(tinymce.activeEditor.getContent())})}})});